!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).htmlcomponent=e()}(this,(function(){"use strict";var t=window,e=[],n={},o={autoinit:!1,observe:!1,attr:"data-hc",attrData:"data-hcd",attrInit:"data-hci",promiseLoader:window.System&&window.System.import.bind(window.System)||function(t){throw new Error("htmlcomponent: no alternative loader")}};if(t.htmlcomponent)for(var i in o)o[i]=t.htmlcomponent.config[i]||o[i];function r(t,e){var n=[].slice.call(arguments,1);o.promiseLoader(t).then((function(t){"function"==typeof t?t.apply(this,n):"object"==typeof t&&"function"==typeof t.default&&t.default.apply(this,n)}))}function a(t){var e=t.getAttribute(o.attr),n=t.getAttribute(o.attrData),i=t.firstElementChild&&"SCRIPT"==t.firstElementChild.nodeName&&null!=t.firstElementChild.getAttribute(o.attrData)&&t.firstElementChild.innerHTML,a=null;n?a=JSON.parse(n):i&&(a=JSON.parse(i)),function(t,e,n){var i=[e,n,r];o.promiseLoader(t).then((function(t){"function"==typeof t?t.apply(this,i):"object"==typeof t&&"function"==typeof t.default&&t.default.apply(this,i)}))}(e,t,a),t.setAttribute(o.attr+"i",e),t.removeAttribute(o.attr)}if(r.config=o,r.query=function(t){t||(t=document);for(var e=t.querySelectorAll("["+o.attr+"]"),n=0,i=e.length;n<i;n++){a(e[n])}1==t.nodeType&&t.hasAttribute(o.attr)&&a(t)},r.setStaticLoader=function(t){o.promiseLoader=function(e){return{then:function(n){setTimeout((function(){n(t[e])}),0)}}}},r.set=function(t,e){n[t]=e},r.get=function(t){return n[t]},r.send=function(t,n){var o=e[t];o&&o.forEach((function(e){e(t,n)}))},r.listen=function(t,n){var o=e[t];o||(o=e[t]=[]),o.push(n)},r.unlisten=function(t,n){var o=e[t];o&&o.splice(o.indexOf(n),1)},t.htmlcomponent=r,window.MutationObserver&&o.observe){var d=new MutationObserver((function(t){t.forEach((function(t){if("childList"==t.type&&t.addedNodes.length>0)for(var e=0,n=t.addedNodes.length;e<n;e++){1==(i=t.addedNodes[e]).nodeType&&i.hasAttribute(o.attr)&&r.query(i)}else if(t.removedNodes.length>0)for(e=0,n=t.removedNodes.length;e<n;e++){var i;1==(i=t.removedNodes[e]).nodeType&&i.hasAttribute(o.attrInit)&&r.destroy(i)}}))}));d.observe(document,{subtree:!0,attributeFilter:[o.attr],childList:!0})}return r.destroy=function(t){t.__htmlComp_destroy&&(t.__htmlComp_destroy(),t.__htmlComp_destroy=null)},r.onElementDestory=function(t,e){t.__htmlComp_destroy=e},o.autoinit&&r.query(document),r}));
