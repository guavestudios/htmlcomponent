!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).htmlcomponent=e()}(this,(function(){"use strict";var t=window,e=[],o={},n={autoinit:!1,observe:!1,attr:"data-hc",attrData:"data-hcd",attrInit:"data-hci",promiseLoader:window.System&&window.System.import.bind(window.System)||function(t){throw new Error("htmlcomponent: no alternative loader")}};if(t.htmlcomponent)for(var r in n)n[r]=t.htmlcomponent.config[r]||n[r];function i(t,e){var o=[].slice.call(arguments,1);n.promiseLoader(t).then((function(t){"function"==typeof t?t.apply(this,o):"object"==typeof t&&"function"==typeof t.default&&t.default.apply(this,o)}))}function a(t){var e=t.getAttribute(n.attr),o=t.getAttribute(n.attrData),r=t.firstElementChild&&"SCRIPT"==t.firstElementChild.nodeName&&null!=t.firstElementChild.getAttribute(n.attrData)&&t.firstElementChild.innerHTML,a=null;o?a=JSON.parse(o):r&&(a=JSON.parse(r)),function(t,e,o){var r=[e,o,i];n.promiseLoader(t).then((function(t){"function"==typeof t?t.apply(this,r):"object"==typeof t&&"function"==typeof t.default&&t.default.apply(this,r)}))}(e,t,a),t.setAttribute(n.attr+"i",e),t.removeAttribute(n.attr)}function u(t){t.__htmlComp_destroy&&(t.__htmlComp_destroy(),t.__htmlComp_destroy=null)}return i.config=n,i.query=function(t){t||(t=document);for(var e=t.querySelectorAll("["+n.attr+"]"),o=0,r=e.length;o<r;o++){a(e[o])}1==t.nodeType&&t.hasAttribute(n.attr)&&a(t)},i.setStaticLoader=function(t){n.promiseLoader=function(e){return{then:function(o){setTimeout((function(){o(t[e])}),0)}}}},i.set=function(t,e){o[t]=e},i.get=function(t){return o[t]},i.send=function(t,o){var n=e[t];n&&n.forEach((function(e){e(t,o)}))},i.listen=function(t,o){var n=e[t];n||(n=e[t]=[]),n.push(o)},i.unlisten=function(t,o){var n=e[t];n&&n.splice(n.indexOf(o),1)},t.htmlcomponent=i,i.stopObserve=function(){i.observer&&(i.observer.disconnect(),i.observer=null)},i.destroy=function(t){var e=t.querySelectorAll("["+n.attrInit+"]");Array.from(e).forEach((t=>{u(t)})),u(t)},i.onElementDestroy=function(t,e){t.__htmlComp_destroy=e},i.observe=function(t){if(window.MutationObserver&&null==i.observer){var e=new MutationObserver((function(t){t.forEach((function(t){if("childList"==t.type&&t.addedNodes.length>0)for(var e=0,o=t.addedNodes.length;e<o;e++){1==(r=t.addedNodes[e]).nodeType&&r.hasAttribute(n.attr)&&i.query(r)}else if(t.removedNodes.length>0)for(e=0,o=t.removedNodes.length;e<o;e++){var r;(r=t.removedNodes[e]).nodeType===Node.ELEMENT_NODE&&i.destroy(r)}}))}));e.observe(t||document,{subtree:!0,attributeFilter:[n.attr],childList:!0}),i.observer=e}},n.autoinit&&i.query(document),n.observe&&i.observe(),i}));
